#{extends themeInfo.get('themeLayout') /}

#{set title:messages.get('user.admin.profile.title') /}

#{set 'moreScripts'}
<script type="text/javascript" src="@{routes.Assets.at("common/javascripts/jquery.limitChars.min.js")}"></script>
#{/set}

<h1>Your profile</h1>

<div class="row">
    <div class="span8">
        <form id="profileForm" action="">
          #{textField name:"firstName", form:profileForm, label:messages.get('ui.label.firstname'), dataBind:"value: firstName", labelClass:"required", required: true /}
          #{textField name:"lastName", form:profileForm, label:messages.get('ui.label.lastname'), dataBind:"value: lastName", labelClass:"required", required: true /}
          #{textField name:"email", form:profileForm, label:messages.get('ui.label.email'), dataBind:"value: email", labelClass:"required", required: true, help: messages.get('user.admin.profile.gravatarHelp').raw() /}
          #{textArea name:"description", form:profileForm, label:messages.get('user.profile.aboutYou'), dataBind:"value: description", help:messages.get('user.admin.profile.help.aboutYou'), dataMaxChars:"400" /}
          #{textField name:"funFact", form:profileForm, label:messages.get('user.profile.funFact'), dataBind:"value: funFact" /}
          #{textField name:"twitter", form:profileForm, label:"Twitter", dataBind:"value: twitter", help: messages.get('user.admin.profile.help.twitter') /}
          #{textField name:"linkedIn", form:profileForm, label:"LinkedIn", dataBind:"value: linkedIn", help: messages.get('user.admin.profile.help.linkedIn') /}
          #{checkboxField name:"isPublic", form:profileForm, label:messages.get('ui.label.visibility.public'), dataBind:"checked: isPublic", help:messages.get('user.admin.profile.help.public') /}

          <div class="buttons">
            #{btnButton label:messages.get('user.admin.profile.save'), id:"saveButton", extraClass:"blue", type:"submit"  /}
            <div class="wait"></div>
          </div>

        </form>
    </div>
</div>


<script type="text/javascript">
  $(document).ready(function() {

    var profileModel = {};

    load(${data.raw()}, profileModel, null, function() {
      $("body").css('visibility', 'visible');
    });

    $('#saveButton').click(function(event) {
        event.preventDefault();
        handleSubmit('/${userName}/admin/profile', profileModel, '#profileForm', null, function() {
          document.location = '/${userName}';
        });
    });

    $("textarea#description").limitChars({ charCountClass: "small-text", allowOverLimit: false, charsLeftText: '${messages.get('ui.message.charsLeft')}'});

  });
</script>
