%{
switch (_view.nodeType) {

    case "root":
    case "row":
    case "column":

        def propClass;
        switch (_view.attr("proportion")) {
            case "1of2":
                propClass = "span6"
                break
            case "2of3":
                propClass = "span4"
                break
            default:
                propClass = ""
        }}%

        <div class="${_view.nodeType} ${propClass}">
        #{list items: _view.content(), as: 'item'}
            #{view view: item /}
        #{/list}
        </div>
    %{
    break

    case "container":}%
        <div #{if _view.attr("id")}id="${_view.attr("id")}"#{/if}>

        #{if _view.attr("label")}
            <h5>&{_view.attr("label")}</h5>
        #{/if}

        #{if _view.attr("type") == "labelled-list"}
        <dl class="dl">
            #{list items: _view.content(), as: 'i'}
                #{view view: i /}
            #{/list}
        </dl>
        #{/if}

        #{elseif _view.attr("type") == "list" }
        <ul>
            #{list items: _view.content(), as: 'i'}
                #{view view: i /}
            #{/list}
        </ul>
        #{/elseif}

        #{else}
            #{list items: _view.content(), as: 'i'}
                #{view view: i /}
            #{/list}
        #{/else}

        </div>
    %{
    break

    case "field": if (_view.text()){ }%
        #{if _view.parent.attr("labelled-list") }
            <dt>&{_view.attr("label")}</dt><dd class="truncate">${_view.text()}</dd>
        #{/if}
        #{elseif _view.parent.attr("type") == "list"}
            <li>${_view.text()}</li>
        #{/elseif}
        #{else}
            #{if _view.attr("label")}
            <h5>&{_view.attr("label")}</h5>
            #{/if}
            <p>${_view.text()}</p>
        #{/else}
    %{ }
    break

    case "link": if (_view.attr("text")){ }%
        #{if !_view.parent.attr("type") || _view.parent.attr("default") }
            <dt>&{_view.attr("label")}</dt><dd><div class="link"><a href="${_view.attr("url")}">${_view.attr("text")}</a></div></dd>
        #{/if}
        #{elseif _view.parent.attr("type") == "list"}
            <li><div class="link"><a href="${_view.attr("url")}">${_view.attr("text")}</a></div></li>
        #{/elseif}
        #{else}
            <div class="link"><a href="${_view.attr("url")}">${_view.attr("text")}</a></div>
        #{/else}


    %{ }
    break

    case "image": if (_view.text()){ }%
        <div class="image img"><img src="${_view.text()}"#{if _view.attr("class")} class="${_view.attr("class")}"#{/if} #{if _view.attr("title")} title="${_view.attr("title")}"#{/if}/></div>
    %{ }
    break

    case "enumeration":}%
        #{if _view.attr("label")}
            <h5>&{_view.attr("label")}</h5>
        #{/if}
        <p>#{list _view.content(), as: 'e'}${e.text()}#{if !e_isLast}${_view.attr("separator")}#{/if}#{/list}</p>
    %{
    break

    case "list":}%
        #{list items: _view.content(), as: 'item'}
            #{view view: item /}
        #{/list}
    %{
    break


}
}%