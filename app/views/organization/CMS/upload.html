#{extends themeInfo.get('themeLayout') /}

#{set title: messages.get('org.cms.upload') /}

#{set bodyId: 'organization' /}

#{breadcrumbs request: request, theme: themeInfo.getTheme() /}

#{organizationNavBar orgId: orgId, active:"site", isOwner: isOwner, isCMSAdmin: isCMSAdmin /}

<div class="row">


    <div class="span6">
        <p>&{'org.cms.upload.image.explain'}</p>
    </div>
    <div class="span6">
        <div id="fileupload">
            <form action="#" method="post" enctype="multipart/form-data" class="form-inline form-delving">
                <div class="well">
                    <div class="control-group">
                        <label class="control-label" for="fileInput">&{'ui.label.filesadd'}</label>
                        <div class="controls">
                            <input type="file" name="files[]" id="fileInput" multiple="true" class="btn input-file" />
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

</div>
<div class="row">
    <div class="fileupload-content span12">
        <table class="files table table-striped">
            <caption>Uploaded files</caption>
            <thead>
                <th>Thumbnail</th>
                <th>File name</th>
                <th>File size</th>
                <th colspan="2"></th>
                <th>Actions</th>
            </thead>
            <tbody>

            </tbody>
        </table>
    </div>
</div>







<script type="text/javascript">
    $(document).ready(function () {

        initUploadWidget(false);

        $('#fileupload').fileupload({
            url:'@{controllers.user.routes.FileUpload.uploadFile(uid)}',
            autoUpload:true
        }).bind('fileuploaddone', function (e, data) {
                    $.post('/organizations/${orgId}/site/upload/${uid}');
                });

        var files = ${files.raw()};
        var fu = $('#fileupload').data('fileupload');
        fu._adjustMaxNumberOfFiles(-files.length);
        fu._renderDownload(files)
                .appendTo($('.fileupload-content .files tbody'))
                .fadeIn(function () {
                    // Fix for IE7 and lower:
                    $(this).show();
                });

        $("body").css('visibility', 'visible');
        $("table.files td.delete button").addClass("btn btn-danger");

    });

</script>