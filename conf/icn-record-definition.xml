<?xml version="1.0"?>
<!--
  ~ Copyright 2011 Delving B.V.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<record-definition prefix="icn">
    <namespaces>
        <namespace prefix="dc" uri="http://purl.org/dc/elements/1.1/" schema="http://dublincore.org/schemas/xmls/qdc/dc.xsd"/>
        <namespace prefix="dcterms" uri="http://purl.org/dc/terms/" schema="http://dublincore.org/schemas/xmls/qdc/dcterms.xsd"/>
        <namespace prefix="europeana" uri="http://www.europeana.eu/schemas/ese/" schema="http://www.europeana.eu/schemas/ese/ESE-V3.3.xsd"/>
        <namespace prefix="ese" uri="http://www.europeana.eu/schemas/ese/" schema="http://www.europeana.eu/schemas/ese/ESE-V3.3.xsd"/>
        <namespace prefix="icn" uri="http://www.icn.nl/" schema="http://www.icn.nl/schemas/ICN-V3.2.xsd"/>
        <namespace prefix="delving" uri="http://www.delving.eu/" schema="http://www.delving.eu/schemas/delving-1.0.xsd"/>
    </namespaces>
    <!--
    sortable            => default false; action index also with sort_ prefix in fieldname
    searchField         => add content of field to each field specified in the list
    housekeeping        => default false; this field can never be mapped and its value is only used in back-end processes
    facetPrefix         => this is the prefix used during Solr Query construction for multivalued search
                           If facetPrefix is non-empty store this field with prefix facet_ to enable its use as facet.
    facetName           => this is the name used for the facet
    fieldType           => default text; this value is used to determine the fieldType for the Solr search Engine
    multivalued         => default = true; check if field name appears multiple times.
    -->
    <root localName="record">
        <field prefix="icn" localName="creatorYearOfBirth" fieldType="string">
            <converter multipleOutput="true" call=".extractYear()"/>
        </field>
        <field prefix="icn" localName="creatorYearOfDeath" fieldType="string">
            <converter multipleOutput="true" call=".extractYear()"/>
        </field>
        <field prefix="icn" localName="creatorRole"/>
        <field prefix="icn" localName="technique">
            <options>
                <string>Schilderkunst</string>
                <string>Prentkunst</string>
                <string>Fotografie</string>
                <string>Tekeningen</string>
                <string>Beeldhouwkunst</string>
                <string>Textiel</string>
                <string>Film/Video/DVD</string>
                <string>Anders:</string>
            </options>
        </field>
        <field prefix="icn" localName="material"/>
        <field prefix="icn" localName="location"/>
        <field prefix="icn" localName="province"/>
        <field prefix="icn" localName="collectionPart"/>
        <field prefix="icn" localName="acquisitionMeans">
            <options>
                <string>aankoop</string>
                <string>schenking</string>
                <string>bruikleen</string>
                <string>ruil</string>
                <string>opdracht</string>
                <string>opdracht derden</string>
                <string>opdracht museum</string>
                <string>legaat</string>
                <string>overdracht</string>
                <string>successieregeling</string>
                <string>vondst</string>
                <string>onbekend:</string>
            </options>
        </field>
        <field prefix="icn" localName="collectionType">
            <options>
                <string>all</string>
                <string>portal</string>
                <string>mm</string>
            </options>
        </field>
        <field prefix="icn" localName="acquisitionYear" fieldType="string"/>
        <field prefix="icn" localName="purchasePrice"/>
        <field prefix="icn" localName="acquiredWithHelpFrom"/>
        <field prefix="icn" localName="physicalState"/>
        <field prefix="dc" localName="contributor"/>
        <field prefix="dc" localName="coverage"/>
        <field prefix="dc" localName="creator" summaryField="CREATOR"/>
        <field prefix="dc" localName="date"/> <!--removed extract year it doesn't belong here -->
        <field prefix="dc" localName="description" summaryField="DESCRIPTION"/>
        <field prefix="dc" localName="format"/>
        <field prefix="dc" localName="identifier" fieldType="string"/>
        <field prefix="dc" localName="language"/>
        <field prefix="dc" localName="publisher"/>
        <field prefix="dc" localName="relation"/>
        <field prefix="dc" localName="rights"/>
        <field prefix="dc" localName="source"/>
        <field prefix="dc" localName="subject" summaryField="SNIPPET"/>
        <field prefix="dc" localName="title" summaryField="TITLE"/>
        <field prefix="dc" localName="type"/>
        <field prefix="dcterms" localName="alternative" summaryField="SNIPPET"/>
        <field prefix="dcterms" localName="conformsTo"/>
        <field prefix="dcterms" localName="created"/>
        <field prefix="dcterms" localName="extent"/>
        <field prefix="dcterms" localName="hasFormat"/>
        <field prefix="dcterms" localName="hasPart"/>
        <field prefix="dcterms" localName="hasVersion"/>
        <field prefix="dcterms" localName="isFormatOf"/>
        <field prefix="dcterms" localName="isPartOf"/>
        <field prefix="dcterms" localName="isReferencedBy"/>
        <field prefix="dcterms" localName="isReplacedBy"/>
        <field prefix="dcterms" localName="isRequiredBy"/>
        <field prefix="dcterms" localName="isVersionOf"/>
        <field prefix="dcterms" localName="issued"/>
        <field prefix="dcterms" localName="medium"/>
        <field prefix="dcterms" localName="provenance"/>
        <field prefix="dcterms" localName="references"/>
        <field prefix="dcterms" localName="replaces"/>
        <field prefix="dcterms" localName="requires"/>
        <field prefix="dcterms" localName="spatial"/>
        <field prefix="dcterms" localName="tableOfContents"/>
        <field prefix="dcterms" localName="temporal"/>
        <field prefix="dcterms" localName="rightsHolder"/>
        <field prefix="europeana" localName="collectionName" factName="spec"/>
        <field prefix="europeana" localName="collectionTitle" factName="name" summaryField="SNIPPET"/>
        <field prefix="europeana" localName="country" factName="country"/>
        <field prefix="europeana" localName="dataProvider" factName="dataProvider" fieldType="string" summaryField="OWNER"/>
        <field prefix="europeana" localName="isShownAt" fieldType="string" summaryField="LANDING_PAGE"/>
        <field prefix="europeana" localName="isShownBy" fieldType="string"/>
        <field prefix="europeana" localName="language" fieldType="string" factName="language"/>
        <field prefix="europeana" localName="object" fieldType="string" summaryField="THUMBNAIL"/>
        <field prefix="europeana" localName="provider" factName="provider" fieldType="string"/>
        <field prefix="europeana" localName="rights" factName="rights" fieldType="string"/>
        <field prefix="europeana" localName="source"/> <!-- to be deleted is unused -->
        <field prefix="europeana" localName="type" fieldType="string" factName="type"/>
        <field prefix="europeana" localName="unstored" fieldType="text"/>
        <field prefix="europeana" localName="uri" identifierField="true" fieldType="string">
            <converter call=".toLocalId(spec)"/>
        </field>
        <field prefix="delving" localName="year" fieldType="string">
            <converter multipleOutput="true" call=".extractYear()"/>
        </field>
        <field prefix="delving" localName="thumbnail" fieldType="string" summaryField="THUMBNAIL"/>
        <field prefix="delving" localName="deepZoomUrl" fieldType="string"/>
        <field prefix="delving" localName="fullTextObjectUrl" fieldType="string"/>
        <field prefix="delving" localName="fullText" fieldType="text" summaryField="SNIPPET"/>
    </root>
    <views>
        <view name="full">
            <row>
                <column id="description">
                    <field path="summaryFields/title" label="metadata.dc.description"/>
                </column>
            </row>
        </view>
        <view name="fullTakeOne">
            <row>
                <column id="description">
                    <field path="description" label="metadata.dc.description"/>
                </column>
            </row>
            <row>
                <column name="1">
                    <field path="title" label="metadata.dc.title" />
                    <field label="metadata.dc.type" path="dc_type" queryLink= "true" />
                    <list label="metadata.dcterms.alternative" path="dcterms_alternative, _metadata.dcterms.alternative" listType="concatenated" separator=", " />
                    <field label="metadata.icn.material" path="icn_material" queryLink="true" />
                    <list label="metadata.icn.creatorYearOfBirth" path="icn_creatorYearOfBirth" listType="concatenated" separator=", "  />
                    <list label="metadata.dc.subject" path="dc_subject, dcterms_temporal, dcterms_spatial, dc_coverage" listType="concatenated" separator=", " queryLink="true"  />
                    <field label="metadata.dc.source" path="dc_source" />
                </column>
                <column name="2">
                   <field label="metadata.dc.creator" path="creator" queryLink="true" />
                   <field label="metadata.dc.date" path="year" queryLink="true" />
                   <field label="metadata.dc.language" path="language" />
                   <field label="metadata.europeana.dataProvider" path="dataProvider" />
                   <list type="concatenated" label="metadata.dc.format" path="dc_format, dcterms_extent" separator=", " />
                   <list type="concatenated" label="metadata.dc.relation" path="dc_relation, dcterms_references, dcterms_isReferencedBy, dcterms_isReplacedBy, dcterms_isRequiredBy, dcterms_isPartOf, dcterms_hasPart, dcterms_replaces, dcterms_requires, dcterms_isVersionOf, dcterms_hasVersion, dcterms_conformsTo, dcterms_hasFormat" separator=", " />
                   <field label="metadata.dcterms.provenance" path="dcterms_provenance" />
                   <field label="metadata.icn.technique" path="icn_technique" queryLink="true" />
                </column>
            </row>
        </view>
        <disabledView>
            <view-field name="dc_title" prefix="dc" localName="title"/>
            <view-field name="dc_creator" prefix="dc" localName="creator"/>
            <view-field name="icn_creatorYearOfBirth" prefix="icn" localName="creatorYearOfBirth"/>
            <view-field name="dc_date">
                <field-ref prefix="dc" localName="date"/>
                <field-ref prefix="dcterms" localName="created"/>
                <field-ref prefix="dcterms" localName="issued"/>
            </view-field>
            <view-field name="dc_type" prefix="dc" localName="type"/>
            <view-field name="dc_format">
                <field-ref prefix="dc" localName="format"/>
                <field-ref prefix="dcterms" localName="extent"/>
                <field-ref prefix="dcterms" localName="medium"/>
            </view-field>
            <view-field name="dc_language" prefix="dc" localName="language"/>
            <view-field name="dc_description" prefix="dc" localName="description"/>
            <view-field name="dc_subject">
                <field-ref prefix="dc" localName="subject"/>
                <field-ref prefix="dcterms" localName="temporal"/>
                <field-ref prefix="dcterms" localName="spatial"/>
                <field-ref prefix="dcterms" localName="coverage"/>
            </view-field>
            <view-field name="dc_identifier" prefix="dc" localName="identifier"/>
            <view-field name="dc_source" prefix="dc" localName="source"/>
            <view-field name="dc_rights" prefix="dc" localName="rights"/>
            <view-field name="dc_publisher" prefix="dc" localName="publisher"/>
            <view-field name="dc_provider" prefix="europeana" localName="dataProvider"/>
            <view-field name="dc_relation">
                <field-ref prefix="dc" localName="relation"/>
                <field-ref prefix="dcterms" localName="references"/>
                <field-ref prefix="dcterms" localName="isReferencedBy"/>
                <field-ref prefix="dcterms" localName="isReplacedBy"/>
                <field-ref prefix="dcterms" localName="isRequiredBy"/>
                <field-ref prefix="dcterms" localName="isPartOf"/>
                <field-ref prefix="dcterms" localName="hasPart"/>
                <field-ref prefix="dcterms" localName="replaces"/>
                <field-ref prefix="dcterms" localName="requires"/>
                <field-ref prefix="dcterms" localName="isVersionOf"/>
                <field-ref prefix="dcterms" localName="hasVersion"/>
                <field-ref prefix="dcterms" localName="conformsTo"/>
                <field-ref prefix="dcterms" localName="hasFormat"/>
            </view-field>
            <view-field name="dcterms_provenance" prefix="dcterms" localName="provenance"/>
            <view-field name="icn_technique" prefix="icn" localName="technique"/>
            <view-field name="icn_material" prefix="icn" localName="material"/>
            <view-field name="icn_location" prefix="icn" localName="location"/>
            <view-field name="icn_province" prefix="icn" localName="province"/>
            <view-field name="icn_collectionPart" prefix="icn" localName="collectionPart"/>
            <!--<#if (user??) && (user.role=="ROLE_RESEARCH_USER" || user.role=="ROLE_ADMINISTRATOR" || user.role=="ROLE_GOD" )>-->
            <view-field name="icn_acquisitionMeans" prefix="icn" localName="acquisitionMeans"/>
            <view-field name="icn_acquisitionYear" prefix="icn" localName="acquisitionYear"/>
            <view-field name="icn_acquiredWithHelpFrom" prefix="icn" localName="acquiredWithHelpFrom"/>
            <view-field name="icn_purchasePrice" prefix="icn" localName="purchasePrice"/>
            <view-field name="icn_physicalState" prefix="icn" localName="physicalState"/>
            <!--</#if>-->
        </disabledView>
    </views>
    <validation>
        assert record.'europeana:collectionTitle'
        assert record.'europeana:country'
        assert record.'europeana:dataProvider'
        assert record.'europeana:provider'
        assert record.'europeana:language'
        assert record.'europeana:rights'
        assert record.'europeana:type'
        assert record.'europeana:uri'
        assert record.'europeana:isShownAt' || record.'europeana:isShownBy'
        assert isUrl(record.'europeana:isShownAt')
        assert isOption(record.'icn:acquisitionMeans')
        assert isUnique(record.'europeana:uri')
    </validation>
</record-definition>

