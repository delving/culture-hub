#{fixture 'util.TestDataLoader' /}

#{selenium '1000 - New user registration'}
  clearSession()

  open('/registration/lostPassword')

  # Validation on e-mail to recover
  type('email','wrongEmail')
  clickAndWait('reset')
  verifyTextPresent('Invalid email address')
  type('email','nonExistant@email.com')
  clickAndWait('reset')
  verifyTextPresent('No account could be found with this email address')

  type('email','bob@gmail.com')
  clickAndWait('reset')
  verifyTextPresent('An e-mail has been sent to you with a link to reset your password')

  open('/registration/resetPassword/testResetPasswordToken')

  # Validation on password
  clickAndWait('reset')
  verifyTextPresent('Required')
  type('password1','a')
  type('password2','b')
  clickAndWait('reset')
  verifyTextPresent('Passwords are not the same')

  type('password2','a')
  clickAndWait('reset')
  verifyTextPresent('Your password has been successfully changed ')
#{/selenium}